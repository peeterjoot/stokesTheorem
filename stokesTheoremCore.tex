%
% Copyright Â© 2016 Peeter Joot.  All Rights Reserved.
% Licenced as described in the file LICENSE under the root directory of this GIT repository.
%
\section{Stokes' Theorem}

Stokes' theorem is fairly easy to state, but takes a fair amount of work to understand and unpack its implications.

\input{../gabookI/calculus/stokesTheoremTheStatement.tex}

This dot product defines the oriented surface ``area'' elements associated with the ``volume'' element \( d^k \Bx \).  That area element can be obtained from the mnemonic

\begin{dmath}\label{eqn:stokesTheoremCore:1561}
\sum_i d^k \Bx \cdot \Bx^i,
\end{dmath}

with each of the ith differentials evaluated.  This will be made clear by example.

\section{One parameter specialization of Stokes' theorem.}

An example parameterization with one parameter, and the corresponding differential with respect to that parameter, is plotted in
\cref{fig:oneParameterDifferential:oneParameterDifferentialFig1}, for a parameterization over \( [a, b] \in [0,1]\otimes[0,1] \).

\imageFigure{../figures/oneParameterDifferentialFig1}{One parameter manifold.}{fig:oneParameterDifferential:oneParameterDifferentialFig1}{0.3}

The differential with respect to the parameter \( a \) is

\begin{equation}\label{eqn:stokesTheoremCore:20}
d\Bx_a = \PD{a}{\Bx} da = \Bx_a da.
\end{equation}

On this curve the projection of the gradient has just one component

\begin{dmath}\label{eqn:stokesTheoremCore:40}
\boldpartial
=
\sum_\mu \Bx^\mu (\Bx_\mu \cdot \spacegrad)
=
\Bx^a \PD{a}{}
\equiv
\Bx^a \partial_a.
\end{dmath}

Please see \citep{aMacdonaldVAGC} for a full justification of the curvilinear coordinate representation of the vector derivative (or the gradient).  That text also discusses pertainant issues with the connectivity of the manifold ignored here.

Stokes' theorem for a one parameter manifold can only be expressed for scalar fields.  That is

\begin{dmath}\label{eqn:stokesTheoremCore:60}
\int d\Bx \cdot (\boldpartial \wedge \psi)
=
\int d\Bx \cdot \boldpartial \psi
=
\int da \PD{a}{ \psi }
= \evalbar{\psi}{\Delta a}.
\end{dmath}

Observe that the vector derivative can be replaced by the gradient since \( d\Bx \cdot \boldpartial = d\Bx \cdot \spacegrad \).
This is the case since dotting the
gradient with a differential element \( d\Bx \) on this curve, no component of the gradient that isn't colinear to the curve makes no contribution.

That means that Stokes' theorem for a one parameter curve is exactly the fundamental theorem of calculus for line integrals

%\begin{dmath}\label{eqn:stokesTheoremCore:80}
\boxedEquation{eqn:stokesTheoremCore:80}{
\int_{\Ba}^{\Bb} d\Bx \cdot \spacegrad \psi = \psi(\Bb) - \psi(\Ba).
}
%\end{dmath}

\section{Two parameter specialization of Stokes' theorem.}

An example parameterization with two parameters, and the corresponding differentials with respect to those parameters, is plotted in
\cref{fig:twoParameterDifferential:twoParameterDifferentialFig1}.

\imageFigure{../figures/twoParameterDifferentialFig1}{Two parameter manifold differentials.}{fig:twoParameterDifferential:twoParameterDifferentialFig1}{0.5}

Given parameters \( a, b \), the differentials along each of the parameterization directions are

\begin{dmath}\label{eqn:stokesTheoremCore:100}
\begin{aligned}
d\Bx_a &= \PD{a}{\Bx} da = \Bx_a da \\
d\Bx_b &= \PD{b}{\Bx} db = \Bx_b db.
\end{aligned}
\end{dmath}

The ``volume'' element for this parameterization (a surface area element) is

\begin{equation}\label{eqn:stokesTheoremCore:120}
d^2 \Bx
=
d\Bx_a \wedge
d\Bx_b
=
da db (\Bx_a \wedge \Bx_b).
\end{equation}

The vector derivative, the projection of the gradient onto the surface at the point of integration (also called the tangent space), now has two components

\begin{dmath}\label{eqn:stokesTheoremCore:200}
\boldpartial
=
\sum_\mu \Bx^\mu (\Bx_\mu \cdot \spacegrad)
=
\Bx^a \PD{a}{}
+
\Bx^b \PD{b}{}
\equiv
\Bx^a \partial_a
+
\Bx^b \partial_b.
\end{dmath}

The Stokes integral can be evaluated over this volume element for either scalar fields \( \psi \) or vector fields \( \Bf \), and takes the form

\begin{subequations}
\label{eqn:stokesTheoremCore:140}
\begin{equation}\label{eqn:stokesTheoremCore:160}
\int_A d^2 \Bx \cdot (\boldpartial \wedge \psi) =
\int_A (d^2 \Bx \cdot \boldpartial) \psi
=
\int_{\partial A} d^1 \Bx \psi
\end{equation}
\begin{equation}\label{eqn:stokesTheoremCore:180}
\int_A d^2 \Bx \cdot (\boldpartial \wedge \Bf) =
\int_A (d^2 \Bx \cdot \boldpartial) \cdot \Bf
=
\int_{\partial A} d^1 \Bx \cdot \Bf.
\end{equation}
\end{subequations}

To extract the full meaning of this the boundary differential \( d^1 \Bx \) must be computed.  This has the same structure for a vector or scalar field

\begin{dmath}\label{eqn:stokesTheoremCore:220}
\begin{aligned}
\int_A d^2 \Bx \cdot (\boldpartial \wedge \Bf)
&=
\int_A (d^2 \Bx \cdot \boldpartial) \cdot \Bf \\
&=
\sum_\mu \int_A (d^2 \Bx \cdot \Bx^\mu) \cdot \partial_\mu \Bf \\
&=
\sum_\mu \int_A da db  \lr{ \Bx_a \wedge \Bx_b ) \cdot \Bx^\mu } \cdot \partial_\mu \Bf \\
&=
\sum_\mu \int_A da db  \lr{ \Bx_a {\delta_b}^\mu - \Bx_b {\delta_a}^\mu } \cdot \partial_\mu \Bf \\
&=
\int_A da db  \lr{ \Bx_a \cdot \PD{b}{ \Bf} - \Bx_b \cdot \PD{a}{\Bf} }
\end{aligned}
\end{dmath}

While \( \Bx_a, \Bx_b \) both depend on both parameters \( a, b \), the differential form immediately above is still a perfect integral in the variables of the partials since \( \Bx_a \) is computed with \( b \) held fixed, and \( \Bx_b \) is computed with \( a \) held fixed.  Proceeding with the integrals that match the respective partials, this gives

\begin{dmath}\label{eqn:stokesTheoremCore:240}
\int_A d^2 \Bx \cdot (\boldpartial \wedge \Bf)
=
\int
da \Bx_a \cdot \evalbar{\Bf}{\Delta b}
-\int
db \Bx_b \cdot \evalbar{\Bf}{\Delta a}
=
\int
d\Bx_a \cdot \evalbar{\Bf}{\Delta b}
-\int
d\Bx_b \cdot \evalbar{\Bf}{\Delta a}.
\end{dmath}

This shows that the boundary differential \( d^1 \Bx \) in \cref{eqn:stokesTheoremCore:140} is given by

\begin{dmath}\label{eqn:stokesTheoremCore:260}
d^1 \Bx = d\Bx_a - d\Bx_b,
\end{dmath}

where it is implied that the field in question is evaluated at the boundaries of the parameter that has been eliminated by this first integration.  This boundary integral can be interpretted as the integral around a contour, as indicated in
\cref{fig:twoParameterDifferentialBoundary:twoParameterDifferentialBoundaryFig2}.

\imageFigure{../figures/twoParameterDifferentialBoundaryFig2}{Contour for two parameter surface boundary.}{fig:twoParameterDifferentialBoundary:twoParameterDifferentialBoundaryFig2}{0.4}

Additionally, as with the single parameter case, a substitution of the gradient does not change the result, since any component of the gradient that lies outside of the tangent space on the surface has a zero dot product with the surface volume element \( d^2 \Bx \).
This allows the two parameter Stokes integrals to be written as

%\begin{dmath}\label{eqn:stokesTheoremCore:280}
\boxedEquation{eqn:stokesTheoremCore:280}{
\begin{aligned}
\int_A d^2 \Bx \cdot \spacegrad \psi &= \ointclockwise d\Bx \psi \\
\int_A d^2 \Bx \cdot (\spacegrad \wedge \Bf) &= \ointclockwise d\Bx \cdot \Bf.
\end{aligned}
}
%\end{dmath}

\section{Three parameter specialization of Stokes' theorem.}

An example parameterization with three parameters, and the corresponding differentials with respect to those parameters, and the outwards normals, are sketched in
\cref{fig:normalsOnVolumeAreaElement:normalsOnVolumeAreaElementFig11}.

\imageFigure{../../physicsplay/figures/gabook/normalsOnVolumeAreaElementFig11}{Three parameter volume element.}{fig:normalsOnVolumeAreaElement:normalsOnVolumeAreaElementFig11}{0.4}

Given parameters \( a, b, c \), the differentials along each of the parameterization directions are

\begin{dmath}\label{eqn:stokesTheoremCore:1421}
\begin{aligned}
d\Bx_a &= \PD{a}{\Bx} da = \Bx_a da \\
d\Bx_b &= \PD{b}{\Bx} db = \Bx_b db \\
d\Bx_c &= \PD{c}{\Bx} dc = \Bx_c dc.
\end{aligned}
\end{dmath}

The ``volume'' element for this parameterization (a surface area element) is

\begin{equation}\label{eqn:stokesTheoremCore:1441}
d^3 \Bx
=
d\Bx_a
\wedge
d\Bx_b
\wedge
d\Bx_c
=
da db dc (\Bx_a \wedge \Bx_b \wedge \Bx_c).
\end{equation}

The vector derivative, the projection of the gradient onto the surface at the point of integration (also called the tangent space), now has three components

\begin{dmath}\label{eqn:stokesTheoremCore:1461}
\boldpartial
=
\sum_\mu \Bx^\mu (\Bx_\mu \cdot \spacegrad)
=
\Bx^a \PD{a}{}
+
\Bx^b \PD{b}{}
+
\Bx^c \PD{c}{}
\equiv
\Bx^a \partial_a
+
\Bx^b \partial_b
+
\Bx^c \partial_c.
\end{dmath}

The Stokes integral can be evaluated over this volume element for either scalar fields \( \psi \), vector fields \( \Bf \), or bivector fields \( B \) and takes the form

\begin{subequations}
\label{eqn:stokesTheoremCore:1481}
\begin{equation}\label{eqn:stokesTheoremCore:1501}
\int_V d^3 \Bx \cdot (\boldpartial \wedge \psi) =
\int_V (d^3 \Bx \cdot \boldpartial) \psi
=
\int_{\partial V} d^2 \Bx \psi
\end{equation}
\begin{equation}\label{eqn:stokesTheoremCore:1521}
\int_V d^3 \Bx \cdot (\boldpartial \wedge \Bf) =
\int_V (d^3 \Bx \cdot \boldpartial) \cdot \Bf
=
\int_{\partial V} d^2 \Bx \cdot \Bf
\end{equation}
\begin{equation}\label{eqn:stokesTheoremCore:1541}
\int_V d^3 \Bx \cdot (\boldpartial \wedge B) =
\int_V (d^3 \Bx \cdot \boldpartial) \cdot B
=
\int_{\partial V} d^2 \Bx \cdot B.
\end{equation}
\end{subequations}

When working with \R{3} vector spaces, \( \boldpartial = \spacegrad \), but in higher dimensional spaces, the gradient can also be substituted above due using the same arguments about projection onto the tangent space.

An explicit value for the differential form of the boundary integral is desired and can be obtained from the mnemonic \cref{eqn:stokesTheoremCore:1561}

\begin{dmath}\label{eqn:stokesTheoremCore:1581}
\sum_i d^3 \Bx \cdot \Bx^i
=
\sum_i da db dc \lr{ \Bx_a \wedge \Bx_b \wedge \Bx_c } \cdot \Bx^i
=
\sum_i da db dc \lr{
\Bx_a \wedge \Bx_b +
\Bx_b \wedge \Bx_c +
\Bx_c \wedge \Bx_a }.
\end{dmath}

The bounding form for the three parameter volume is therefore

\begin{dmath}\label{eqn:stokesTheoremCore:1601}
d^2 \Bx
=
d\Bx_a \wedge d\Bx_b +
d\Bx_b \wedge d\Bx_c +
d\Bx_c \wedge d\Bx_a.
\end{dmath}

\section{Using scalar volume elements}

In \R{3} the area and volume elements of \cref{eqn:stokesTheoremCore:140}, and \cref{eqn:stokesTheoremCore:1481} can be reexpressed as scalars, recovering a number of the integral calculus identities that are more familiar than the wedge product variants above.

The pseudoscalar volume element can be written

\begin{dmath}\label{eqn:stokesTheoremCore:1621}
d^3 \Bx = I dV,
\end{dmath}

and the (oriented) area elements can be written as

\begin{dmath}\label{eqn:stokesTheoremCore:1641}
d^2 \Bx \ncap = I dA,
\end{dmath}

or
\begin{dmath}\label{eqn:stokesTheoremCore:1661}
d^2 \Bx = I \ncap dA.
\end{dmath}

For \( \psi \in \bigwedge^0, \BA \in \bigwedge^1, B \in \bigwedge^2 \), this gives

\begin{subequations}
\label{eqn:stokesTheoremCore:1681}
\begin{equation}\label{eqn:stokesTheoremCore:1701}
I \int_A dA \ncap \wedge \spacegrad \psi = \ointclockwise d\Bx \psi
\end{equation}
\begin{equation}\label{eqn:stokesTheoremCore:1721}
I \int_A dA \ncap \wedge \spacegrad \wedge \BA = \ointclockwise d\Bx \psi
\end{equation}
\begin{equation}\label{eqn:stokesTheoremCore:1741}
\int_V dV \spacegrad \psi = \int_{\partial V} dA \ncap \psi
\end{equation}
\begin{equation}\label{eqn:stokesTheoremCore:1761}
\int_V dV \spacegrad \wedge \BA = \int_{\partial V} dA \ncap \wedge \BA
\end{equation}
\begin{equation}\label{eqn:stokesTheoremCore:1781}
\int dV \spacegrad \wedge B = \int_{\partial V} dA \ncap \wedge B
\end{equation}
\end{subequations}

It is simple to reexpress all the wedge products above in their dual forms.  With \( B = I \BA \), that is

\begin{subequations}
\label{eqn:stokesTheoremCore:1801}
\begin{equation}\label{eqn:stokesTheoremCore:1821}
\int_A dA \ncap \cross \spacegrad \psi = \ointctrclockwise d\Bx \psi
\end{equation}
\begin{equation}\label{eqn:stokesTheoremCore:1841}
\int_A dA \ncap \cdot (\spacegrad \cross \BA) = \ointctrclockwise d\Bx \psi
\end{equation}
\begin{equation}\label{eqn:stokesTheoremCore:1861}
\int_V dV \spacegrad \psi = \int_{\partial V} dA \ncap \psi
\end{equation}
\begin{equation}\label{eqn:stokesTheoremCore:1881}
\int_V dV \spacegrad \cross \BA = \int_{\partial V} dA \ncap \cross \BA
\end{equation}
\begin{equation}\label{eqn:stokesTheoremCore:1901}
\int dV \spacegrad \cdot \BA = \int_{\partial V} dA \ncap \cdot \BA.
\end{equation}
\end{subequations}

\section{Helper theorem}

\input{../gabookI/appendix/wedgeDistributionIdentity.tex}

\section{Problems}
